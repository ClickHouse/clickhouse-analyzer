###########################################
# Input SQL                               #
###########################################

WITH
  a,
  b
SELECT
  column_a,
  column_b,
  "column c",
  json.nested.path "jsonNestedPath",
  (SELECT sub_a FROM sub_table),
  (column_d + column_e) + column_f,
  testFunc(5)(column_g) + 5,
  (SELECT 1) + (SELECT 2 FROM system."numbers") as subquery_result,
  my_int::Array(Tuple(Array(Int64), String)) casted_tuple,
  arrayMap((x, y) -> x + 1, (u, v) -> v + 1, [6, 7, 8, 9, (10), (SELECT 1 FROM system.numbers)]) "array thing"
FROM table
ORDER BY b;

SELECT column_1;
SELECT column, "quoted column", 'test', 3.14, 123;
SELECT column_3 as c3, json.nested.path "jsonNestedPath" FROM table3;
FROM system.numbers SELECT number WHERE number > 1 OR number < 5 AND 1=1 LIMIT 1;

###########################################
# Output CST                              #
###########################################

File
  SelectStatement
    WithClause
      'WITH'
      ColumnList
        ColumnReference
          'a'
        ','
        ColumnReference
          'b'
    SelectClause
      'SELECT'
      ColumnList
        ColumnReference
          'column_a'
        ','
        ColumnReference
          'column_b'
        ','
        ColumnReference
          '"column c"'
        ','
        ColumnReference
          'json'
          '.'
          ColumnReference
            'nested'
            '.'
            ColumnReference
              'path'
        ColumnAlias
          '"jsonNestedPath"'
        ','
        Expression
          '('
          SubqueryExpression
            SelectStatement
              SelectClause
                'SELECT'
                ColumnList
                  ColumnReference
                    'sub_a'
              FromClause
                'FROM'
                TableIdentifier
                  'sub_table'
          ')'
        ','
        BinaryExpression
          Expression
            '('
            BinaryExpression
              ColumnReference
                'column_d'
              '+'
              ColumnReference
                'column_e'
            ')'
          '+'
          ColumnReference
            'column_f'
        ','
        BinaryExpression
          FunctionCall
            FunctionCall
              ColumnReference
                'testFunc'
              ExpressionList
                '('
                Expression
                  NumberLiteral
                    '5'
                ')'
            ExpressionList
              '('
              Expression
                ColumnReference
                  'column_g'
              ')'
          '+'
          NumberLiteral
            '5'
        ','
        BinaryExpression
          Expression
            '('
            SubqueryExpression
              SelectStatement
                SelectClause
                  'SELECT'
                  ColumnList
                    NumberLiteral
                      '1'
            ')'
          '+'
          Expression
            '('
            SubqueryExpression
              SelectStatement
                SelectClause
                  'SELECT'
                  ColumnList
                    NumberLiteral
                      '2'
                FromClause
                  'FROM'
                  TableIdentifier
                    'system'
                    '.'
                    '"numbers"'
            ')'
        ColumnAlias
          'as'
          'subquery_result'
        ','
        CastExpression
          ColumnReference
            'my_int'
          '::'
          DataType
            'Array'
            DataTypeParameters
              '('
              DataType
                'Tuple'
                DataTypeParameters
                  '('
                  DataType
                    'Array'
                    DataTypeParameters
                      '('
                      DataType
                        'Int64'
                      ')'
                  ','
                  DataType
                    'String'
                  ')'
              ')'
        ColumnAlias
          'casted_tuple'
        ','
        FunctionCall
          ColumnReference
            'arrayMap'
          ExpressionList
            '('
            LambdaExpression
              TupleExpression
                '('
                ColumnReference
                  'x'
                ','
                ColumnReference
                  'y'
                ')'
              '->'
              BinaryExpression
                ColumnReference
                  'x'
                '+'
                NumberLiteral
                  '1'
            ','
            LambdaExpression
              TupleExpression
                '('
                ColumnReference
                  'u'
                ','
                ColumnReference
                  'v'
                ')'
              '->'
              BinaryExpression
                ColumnReference
                  'v'
                '+'
                NumberLiteral
                  '1'
            ','
            Expression
              ArrayExpression
                '['
                NumberLiteral
                  '6'
                ','
                NumberLiteral
                  '7'
                ','
                NumberLiteral
                  '8'
                ','
                NumberLiteral
                  '9'
                ','
                Expression
                  '('
                  NumberLiteral
                    '10'
                  ')'
                ','
                Expression
                  '('
                  SubqueryExpression
                    SelectStatement
                      SelectClause
                        'SELECT'
                        ColumnList
                          NumberLiteral
                            '1'
                      FromClause
                        'FROM'
                        TableIdentifier
                          'system'
                          '.'
                          'numbers'
                  ')'
                ']'
            ')'
        ColumnAlias
          '"array thing"'
    FromClause
      'FROM'
      TableIdentifier
        'table'
    OrderByClause
      'ORDER'
      'BY'
      OrderByItem
        ColumnReference
          'b'
  ';'
  SelectStatement
    SelectClause
      'SELECT'
      ColumnList
        ColumnReference
          'column_1'
  ';'
  SelectStatement
    SelectClause
      'SELECT'
      ColumnList
        ColumnReference
          'column'
        ','
        ColumnReference
          '"quoted column"'
        ','
        StringLiteral
          ''test''
        ','
        NumberLiteral
          '3.14'
        ','
        NumberLiteral
          '123'
  ';'
  SelectStatement
    SelectClause
      'SELECT'
      ColumnList
        ColumnReference
          'column_3'
        ColumnAlias
          'as'
          'c3'
        ','
        ColumnReference
          'json'
          '.'
          ColumnReference
            'nested'
            '.'
            ColumnReference
              'path'
        ColumnAlias
          '"jsonNestedPath"'
    FromClause
      'FROM'
      TableIdentifier
        'table3'
  ';'
  SelectStatement
    FromClause
      'FROM'
      TableIdentifier
        'system'
        '.'
        'numbers'
    SelectClause
      'SELECT'
      ColumnList
        ColumnReference
          'number'
    WhereClause
      'WHERE'
      BinaryExpression
        BinaryExpression
          BinaryExpression
            ColumnReference
              'number'
            '>'
            NumberLiteral
              '1'
          'OR'
          BinaryExpression
            ColumnReference
              'number'
            '<'
            NumberLiteral
              '5'
        'AND'
        BinaryExpression
          NumberLiteral
            '1'
          '='
          NumberLiteral
            '1'
    LimitClause
      'LIMIT'
      NumberLiteral
        '1'
  ';'
